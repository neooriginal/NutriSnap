/* ═══════════════════════════════════════════════════════════════
   NutriSnap — Design System
   Dark theme · Green accent · Glass morphism
   ═══════════════════════════════════════════════════════════════ */

/* ─── Reset & Custom Properties ──────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:          #0f0f13;
  --bg2:         #17171e;
  --bg3:         #1e1e28;
  --surface:     rgba(255,255,255,0.04);
  --surface-hov: rgba(255,255,255,0.07);
  --border:      rgba(255,255,255,0.08);
  --border-hov:  rgba(255,255,255,0.14);
  --accent:      #4ade80;
  --accent2:     #22c55e;
  --accent-dim:  rgba(74,222,128,0.15);
  --accent-glow: rgba(74,222,128,0.3);
  --text:        #f5f5fa;
  --text2:       #9898b0;
  --text3:       #5a5a72;
  --protein:     #a78bfa;
  --carbs:       #fbbf24;
  --fat:         #f87171;
  --fiber:       #34d399;
  --danger:      #ef4444;
  --warn:        #f59e0b;
  --radius:      16px;
  --radius-sm:   10px;
  --radius-lg:   24px;
  --shadow:      0 8px 32px rgba(0,0,0,0.5);
  --shadow-sm:   0 2px 12px rgba(0,0,0,0.4);
  --font:        'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --nav-h:       72px;
  --top-h:       60px;
  --ease:        cubic-bezier(0.16, 1, 0.3, 1);
}

/* ─── Base ────────────────────────────────────────────────────── */
html { height: 100%; scroll-behavior: smooth; }

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  min-height: 100%;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ─── Utilities ───────────────────────────────────────────────── */
.hidden   { display: none !important; }
.glass    {
  background: var(--surface);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

/* ─── Screens ─────────────────────────────────────────────────── */
.screen { display: none; min-height: 100vh; }
.screen.active { display: block; }

/* ─── Toast ──────────────────────────────────────────────────── */
.toast {
  position: fixed;
  bottom: calc(var(--nav-h) + 16px);
  left: 50%; transform: translateX(-50%) translateY(20px);
  background: var(--bg3);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 12px 20px;
  border-radius: 40px;
  font-size: 14px;
  font-weight: 500;
  z-index: 9999;
  opacity: 0;
  transition: opacity .25s, transform .25s var(--ease);
  pointer-events: none;
  white-space: nowrap;
  max-width: 90vw;
}
.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}
.toast.success { border-color: var(--accent); color: var(--accent); }
.toast.error   { border-color: var(--danger); color: var(--danger); }

/* ═══════════════════════════════════════════════════════════════
   AUTH SCREEN
   ═══════════════════════════════════════════════════════════════ */

.auth-bg {
  position: fixed; inset: 0; z-index: 0;
  overflow: hidden; pointer-events: none;
}
.auth-blob {
  position: absolute; border-radius: 50%;
  filter: blur(80px); opacity: .35;
}
.blob1 { width: 500px; height: 500px; background: #14532d; top: -150px; right: -150px; animation: float1 12s ease-in-out infinite; }
.blob2 { width: 400px; height: 400px; background: #1e3a5f; bottom: -100px; left: -100px; animation: float1 16s ease-in-out infinite reverse; }
.blob3 { width: 300px; height: 300px; background: #4a1d96; top: 40%; left: 40%; animation: float1 10s ease-in-out infinite 2s; }

@keyframes float1 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33%       { transform: translate(30px, -20px) scale(1.05); }
  66%       { transform: translate(-20px, 15px) scale(.95); }
}

.auth-container {
  position: relative; z-index: 1;
  min-height: 100vh;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 24px 20px;
  gap: 28px;
}

.auth-logo { text-align: center; }
.logo-icon { font-size: 56px; display: block; margin-bottom: 8px;
  animation: bounce-in .6s var(--ease); }
.logo-name  { font-size: 32px; font-weight: 800; letter-spacing: -.5px; }
.logo-tagline { color: var(--text2); font-size: 14px; margin-top: 4px; }

@keyframes bounce-in {
  0%   { transform: scale(0) rotate(-20deg); opacity: 0; }
  70%  { transform: scale(1.15) rotate(5deg); }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

.auth-card {
  width: 100%; max-width: 460px;
  padding: 28px;
  animation: slide-up .5s var(--ease);
}
.auth-card h2 { font-size: 22px; font-weight: 700; margin-bottom: 4px; }
.auth-sub     { color: var(--text2); font-size: 14px; margin-bottom: 20px; }
.auth-switch  { text-align: center; color: var(--text2); font-size: 13px; margin-top: 16px; }
.auth-switch a { color: var(--accent); text-decoration: none; font-weight: 600; }
.auth-switch a:hover { text-decoration: underline; }

@keyframes slide-up {
  from { transform: translateY(24px); opacity: 0; }
  to   { transform: translateY(0);    opacity: 1; }
}

/* ─── Forms ──────────────────────────────────────────────────── */
.form-group { display: flex; flex-direction: column; gap: 6px; flex: 1; }
.form-row   { display: flex; gap: 12px; flex-wrap: wrap; }
.form-row .form-group { min-width: 120px; }

label {
  font-size: 12px; font-weight: 600;
  color: var(--text2); text-transform: uppercase; letter-spacing: .04em;
}

input, select, textarea {
  background: rgba(255,255,255,0.05);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text);
  font-family: var(--font);
  font-size: 14px;
  padding: 10px 14px;
  outline: none;
  transition: border-color .2s, box-shadow .2s;
  width: 100%;
  appearance: none;
  -webkit-appearance: none;
}
input:focus, select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-dim);
}
select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%239898b0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
  cursor: pointer;
}
select option { background: var(--bg2); }

.form-group { margin-bottom: 12px; }

/* ─── Buttons ─────────────────────────────────────────────────── */
.btn-primary {
  display: flex; align-items: center; justify-content: center;
  gap: 8px; width: 100%;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: #0a1a0f;
  font-family: var(--font);
  font-size: 15px; font-weight: 700;
  border: none; border-radius: var(--radius-sm);
  padding: 13px 24px;
  cursor: pointer;
  transition: transform .15s, box-shadow .15s, opacity .15s;
  margin-top: 8px;
}
.btn-primary:hover  { transform: translateY(-1px); box-shadow: 0 6px 20px var(--accent-glow); }
.btn-primary:active { transform: translateY(0); }
.btn-primary:disabled { opacity: .5; cursor: not-allowed; transform: none; }
.btn-primary.sm { font-size: 13px; padding: 9px 18px; margin-top: 12px; width: auto; }
.btn-primary svg { width: 16px; height: 16px; }

.btn-ghost {
  display: flex; align-items: center; gap: 6px;
  background: var(--surface); border: 1px solid var(--border);
  color: var(--accent); font-family: var(--font);
  font-size: 13px; font-weight: 600;
  border-radius: var(--radius-sm);
  padding: 7px 14px; cursor: pointer;
  transition: background .15s;
}
.btn-ghost:hover { background: var(--accent-dim); }
.btn-ghost svg { width: 14px; height: 14px; stroke: var(--accent); }

.icon-btn {
  background: none; border: none;
  color: var(--text2); cursor: pointer;
  padding: 8px; border-radius: 8px;
  transition: background .15s, color .15s;
}
.icon-btn:hover { background: var(--surface); color: var(--text); }
.icon-btn svg { width: 20px; height: 20px; display: block; }

.error-msg {
  background: rgba(239,68,68,.1); border: 1px solid rgba(239,68,68,.3);
  color: var(--danger); font-size: 13px; padding: 10px 14px;
  border-radius: var(--radius-sm); margin-bottom: 4px;
}

/* ═══════════════════════════════════════════════════════════════
   APP SCREEN
   ═══════════════════════════════════════════════════════════════ */

#app-screen {
  display: none;
  flex-direction: column;
  min-height: 100vh;
  padding-top: var(--top-h);
  padding-bottom: var(--nav-h);
}
#app-screen.active { display: flex; }

/* ─── Top Bar ─────────────────────────────────────────────────── */
.topbar {
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  height: var(--top-h);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px;
  border-radius: 0;
  border-top: none; border-left: none; border-right: none;
}
.topbar-left  { display: flex; align-items: center; gap: 10px; }
.topbar-logo  { font-size: 22px; }
.topbar-title { font-size: 18px; font-weight: 800; letter-spacing: -.3px; }
.topbar-right { display: flex; align-items: center; gap: 12px; }
.topbar-date  { font-size: 12px; color: var(--text2); font-weight: 500; }

/* ─── Tab Content ─────────────────────────────────────────────── */
.tab-content   { display: none; flex: 1; }
.tab-content.active { display: block; }

.scroll-container {
  padding: 20px 20px calc(20px + env(safe-area-inset-bottom));
  max-width: 600px; margin: 0 auto;
}

/* ─── Bottom Nav ──────────────────────────────────────────────── */
.bottom-nav {
  position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
  height: var(--nav-h);
  display: flex; align-items: stretch;
  padding: 0 8px;
  border-radius: 0; border-bottom: none; border-left: none; border-right: none;
  padding-bottom: env(safe-area-inset-bottom);
}
.nav-btn {
  flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 4px; background: none; border: none; cursor: pointer;
  color: var(--text3); font-family: var(--font);
  transition: color .2s;
  position: relative; padding: 8px 0 4px;
}
.nav-btn svg   { width: 22px; height: 22px; transition: transform .2s var(--ease); }
.nav-btn span  { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: .05em; }
.nav-btn.active { color: var(--accent); }
.nav-btn.active svg { transform: scale(1.1); }

.nav-cam-btn {
  width: 48px; height: 48px; margin-bottom: 2px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border-radius: 16px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 16px var(--accent-glow);
  transition: transform .2s var(--ease);
}
.nav-btn[data-tab="camera"] svg { stroke: #0a1a0f; }
.nav-btn[data-tab="camera"].active .nav-cam-btn,
.nav-btn[data-tab="camera"]:hover .nav-cam-btn { transform: translateY(-4px) scale(1.05); }

/* ═══════════════════════════════════════════════════════════════
   DASHBOARD TAB
   ═══════════════════════════════════════════════════════════════ */

/* Hero section */
.hero-section {
  display: flex; align-items: center; justify-content: space-between;
  gap: 16px; margin-bottom: 20px;
}
.greeting h2 { font-size: 24px; font-weight: 800; letter-spacing: -.5px; }
.greeting p  { color: var(--text2); font-size: 14px; margin-top: 4px; }

/* Calorie ring */
.calorie-ring-wrapper {
  position: relative; flex-shrink: 0;
}
.calorie-ring-wrapper canvas { display: block; }
.ring-center {
  position: absolute; inset: 0;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.ring-cal    { font-size: 26px; font-weight: 800; line-height: 1; }
.ring-label  { font-size: 10px; font-weight: 600; color: var(--text2); text-transform: uppercase; letter-spacing: .08em; }
.ring-remain { font-size: 11px; color: var(--text3); margin-top: 2px; }

/* Macro cards */
.macro-section {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px; margin-bottom: 24px;
}
.macro-card {
  padding: 12px 14px; display: flex; flex-direction: column; gap: 10px;
}
.macro-bar-wrap {
  height: 4px; background: var(--border); border-radius: 2px; overflow: hidden;
}
.macro-bar { height: 100%; border-radius: 2px; width: 0%; transition: width .8s var(--ease); }
.protein-bar { background: var(--protein); }
.carbs-bar   { background: var(--carbs); }
.fat-bar     { background: var(--fat); }

.macro-info { display: flex; align-items: center; gap: 8px; }
.macro-icon { font-size: 18px; }
.macro-val  { display: block; font-size: 15px; font-weight: 700; }
.macro-name { display: block; font-size: 10px; color: var(--text2); font-weight: 600;
  text-transform: uppercase; letter-spacing: .04em; }

/* Meals section */
.section-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 14px;
}
.section-header h3, .section-header h2 { font-size: 18px; font-weight: 700; }
.pad-top { padding-top: 4px; }

.meals-list { display: flex; flex-direction: column; gap: 8px; }

.empty-state {
  text-align: center; padding: 40px 20px;
  color: var(--text2);
}
.empty-icon { font-size: 48px; display: block; margin-bottom: 12px; }
.empty-state p { font-size: 14px; margin-bottom: 4px; }

.meal-item {
  display: flex; align-items: center; gap: 12px;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 12px 14px;
  transition: background .15s;
  animation: slide-up .3s var(--ease);
}
.meal-item:hover { background: var(--surface-hov); }

.meal-thumb {
  width: 44px; height: 44px; border-radius: 10px;
  overflow: hidden; flex-shrink: 0;
  background: var(--bg3);
  display: flex; align-items: center; justify-content: center;
  font-size: 22px;
}
.meal-thumb img { width: 100%; height: 100%; object-fit: cover; }

.meal-info { flex: 1; min-width: 0; }
.meal-name { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.meal-meta { font-size: 12px; color: var(--text2); margin-top: 2px; }
.meal-type-badge {
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  padding: 2px 6px; border-radius: 4px; letter-spacing: .05em;
}
.meal-type-badge.breakfast { background: rgba(251,191,36,.15); color: var(--carbs); }
.meal-type-badge.lunch     { background: rgba(74,222,128,.15); color: var(--accent); }
.meal-type-badge.dinner    { background: rgba(167,139,250,.15); color: var(--protein); }
.meal-type-badge.snack     { background: rgba(248,113,113,.15); color: var(--fat); }

.meal-calories { text-align: right; }
.meal-cal-num  { font-size: 16px; font-weight: 700; }
.meal-cal-unit { font-size: 10px; color: var(--text2); display: block; }

.meal-delete {
  background: none; border: none; cursor: pointer;
  color: var(--text3); padding: 6px; border-radius: 6px;
  transition: color .15s, background .15s;
  flex-shrink: 0;
}
.meal-delete:hover { color: var(--danger); background: rgba(239,68,68,.1); }
.meal-delete svg { width: 15px; height: 15px; display: block; }

/* ═══════════════════════════════════════════════════════════════
   CAMERA TAB
   ═══════════════════════════════════════════════════════════════ */

.camera-header {
  margin-bottom: 20px;
}
.camera-header h2 { font-size: 24px; font-weight: 800; letter-spacing: -.5px; }
.camera-header p  { color: var(--text2); font-size: 14px; margin-top: 4px; }

.camera-area {
  overflow: hidden; margin-bottom: 16px;
}
.camera-placeholder {
  position: relative;
  aspect-ratio: 4/3;
  background: var(--bg2);
  overflow: hidden;
  display: flex; align-items: center; justify-content: center;
}
#camera-video, #preview-img {
  width: 100%; height: 100%; object-fit: cover;
  display: block;
}

.camera-idle {
  display: flex; flex-direction: column; align-items: center;
  gap: 12px; color: var(--text3);
  padding: 20px;
}
.camera-icon-wrap {
  width: 72px; height: 72px;
  background: var(--bg3); border: 2px dashed var(--border);
  border-radius: 20px;
  display: flex; align-items: center; justify-content: center;
}
.camera-icon-wrap svg { width: 32px; height: 32px; stroke: var(--text3); }
.camera-idle p { font-size: 13px; text-align: center; }

.camera-actions {
  display: flex; gap: 8px; padding: 12px;
  flex-wrap: wrap;
}
.btn-cam-action {
  flex: 1; min-width: 80px;
  display: flex; flex-direction: column; align-items: center; gap: 5px;
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); font-family: var(--font);
  font-size: 11px; font-weight: 600;
  border-radius: var(--radius-sm);
  padding: 10px 8px; cursor: pointer;
  transition: background .15s, color .15s, border-color .15s;
}
.btn-cam-action svg { width: 20px; height: 20px; }
.btn-cam-action:hover { background: var(--surface-hov); color: var(--text); border-color: var(--border-hov); }
.btn-cam-action.accent {
  background: var(--accent-dim); border-color: var(--accent); color: var(--accent);
}
.btn-cam-action.danger {
  background: rgba(239,68,68,.1); border-color: rgba(239,68,68,.3); color: var(--danger);
}

.analyze-btn {
  border-radius: var(--radius-sm);
  animation: pulse-accent 2s ease-in-out infinite;
}
@keyframes pulse-accent {
  0%, 100% { box-shadow: 0 0 0 0 var(--accent-glow); }
  50%       { box-shadow: 0 0 0 8px transparent; }
}

/* Analyzing loader */
.analyzing-loader {
  text-align: center; padding: 28px;
}
.analyzing-loader p { color: var(--text2); font-size: 14px; margin-top: 12px; }

.loader-dots { display: flex; gap: 8px; justify-content: center; }
.loader-dots span {
  width: 10px; height: 10px; background: var(--accent);
  border-radius: 50%; animation: dot-bounce 1.4s ease-in-out infinite;
}
.loader-dots span:nth-child(2) { animation-delay: .2s; }
.loader-dots span:nth-child(3) { animation-delay: .4s; }

@keyframes dot-bounce {
  0%, 80%, 100% { transform: scale(0.7); opacity: .4; }
  40%           { transform: scale(1);   opacity: 1; }
}

/* Analysis card */
.analysis-card { padding: 20px; animation: slide-up .4s var(--ease); }

.analysis-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  gap: 12px; margin-bottom: 20px;
}
.analysis-header h3 { font-size: 18px; font-weight: 700; }
.result-desc { color: var(--text2); font-size: 13px; margin-top: 4px; line-height: 1.5; }
.serving-badge {
  display: inline-block; margin-top: 8px;
  font-size: 11px; font-weight: 600; color: var(--text3);
  background: var(--bg3); border: 1px solid var(--border);
  padding: 3px 8px; border-radius: 20px;
}

.confidence-badge {
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  padding: 4px 10px; border-radius: 20px; white-space: nowrap; flex-shrink: 0;
  letter-spacing: .05em;
}
.confidence-badge.high   { background: rgba(74,222,128,.15); color: var(--accent); }
.confidence-badge.medium { background: rgba(251,191,36,.15); color: var(--carbs); }
.confidence-badge.low    { background: rgba(248,113,113,.15); color: var(--fat); }

.result-macros {
  display: grid; grid-template-columns: repeat(4, 1fr);
  gap: 8px; margin-bottom: 20px;
}
.result-macro-item {
  background: var(--bg3); border-radius: var(--radius-sm);
  padding: 12px 10px; text-align: center;
  display: flex; flex-direction: column; align-items: center; gap: 2px;
}
.result-macro-item.calories { border-bottom: 2px solid var(--accent); }
.result-macro-item.protein  { border-bottom: 2px solid var(--protein); }
.result-macro-item.carbs    { border-bottom: 2px solid var(--carbs); }
.result-macro-item.fat      { border-bottom: 2px solid var(--fat); }
.rm-value { font-size: 20px; font-weight: 800; line-height: 1; }
.rm-unit  { font-size: 10px; color: var(--text3); }
.rm-label { font-size: 10px; color: var(--text2); font-weight: 600; text-transform: uppercase; letter-spacing: .04em; }

.result-edit { margin-bottom: 8px; }
.result-edit .form-row { margin-bottom: 0; }
.amount-group { flex: 0 0 76px; min-width: 76px; }
.amount-group input { text-align: center; }

/* ═══════════════════════════════════════════════════════════════
   CHARTS TAB
   ═══════════════════════════════════════════════════════════════ */

.range-select {
  width: auto; padding: 7px 30px 7px 12px;
  font-size: 13px;
}

.chart-card {
  padding: 18px; margin-bottom: 14px;
}
.chart-card h4 {
  font-size: 14px; font-weight: 700; color: var(--text2);
  text-transform: uppercase; letter-spacing: .06em;
  margin-bottom: 16px;
}
.chart-wrap     { position: relative; height: 200px; }
.chart-wrap-sm  { position: relative; height: 180px; max-width: 260px; margin: 0 auto; }

.stats-row {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px; margin-top: 4px;
}
.stats-row-item {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 12px;
  text-align: center;
}
.sri-val   { display: block; font-size: 18px; font-weight: 800; }
.sri-label { display: block; font-size: 10px; color: var(--text2); font-weight: 600;
  text-transform: uppercase; letter-spacing: .04em; margin-top: 2px; }

/* ═══════════════════════════════════════════════════════════════
   PROFILE TAB
   ═══════════════════════════════════════════════════════════════ */

.profile-header {
  text-align: center; margin-bottom: 24px;
}
.profile-avatar {
  width: 72px; height: 72px; border-radius: 24px;
  background: linear-gradient(135deg, var(--accent), #1e7e4d);
  font-size: 28px; font-weight: 800; color: #0a1a0f;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 12px;
}
.profile-header h2 { font-size: 22px; font-weight: 800; }
.profile-email     { color: var(--text2); font-size: 14px; margin-top: 4px; }

.stats-grid {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 10px; margin-bottom: 16px;
}

.stat-card {
  padding: 16px; display: flex; flex-direction: column; gap: 6px;
}
.stat-card.bmi-card { grid-column: 1 / -1; }
.stat-top    { display: flex; align-items: center; justify-content: space-between; }
.stat-label  { font-size: 11px; color: var(--text2); font-weight: 600; text-transform: uppercase; letter-spacing: .05em; }
.stat-sublabel { font-size: 10px; color: var(--text3); font-weight: 400; margin-top: 2px; margin-bottom: 4px; }
.stat-big    { font-size: 30px; font-weight: 800; line-height: 1; }
.stat-big small { font-size: 13px; font-weight: 400; color: var(--text2); }

/* BMI scale */
.bmi-scale { margin-top: 6px; }
.bmi-track {
  height: 6px; border-radius: 3px; position: relative; overflow: hidden;
  background: linear-gradient(to right, #60a5fa 0%, #4ade80 25%, #fbbf24 60%, #f87171 80%, #ef4444 100%);
}
.bmi-thumb {
  position: absolute; top: -3px;
  width: 12px; height: 12px; border-radius: 50%;
  background: #fff; box-shadow: 0 0 6px rgba(0,0,0,.5);
  transform: translateX(-50%);
  transition: left .6s var(--ease);
  left: 0%;
}
.bmi-labels {
  display: flex; justify-content: space-between;
  font-size: 9px; color: var(--text3); font-weight: 600;
  text-transform: uppercase; letter-spacing: .03em;
  margin-top: 4px;
}

.bmi-badge {
  font-size: 11px; font-weight: 700; padding: 3px 8px; border-radius: 20px;
}
.bmi-badge.normal      { background: rgba(74,222,128,.15); color: var(--accent); }
.bmi-badge.underweight { background: rgba(96,165,250,.15); color: #60a5fa; }
.bmi-badge.overweight  { background: rgba(251,191,36,.15); color: var(--carbs); }
.bmi-badge.obese       { background: rgba(239,68,68,.15); color: var(--danger); }

.profile-edit-card {
  padding: 20px;
}
.profile-edit-card h3 {
  font-size: 16px; font-weight: 700; margin-bottom: 16px;
}

.mcp-key-card { padding: 20px; margin-bottom: 14px; }
.mcp-key-card h3 { font-size: 16px; font-weight: 700; }
.mcp-url-row {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg3); border-radius: 8px;
  padding: 8px 12px; margin-top: 12px;
  font-size: 12px; color: var(--text2);
}
.mcp-url-row code {
  flex: 1; font-family: monospace; font-size: 12px;
  color: var(--text1); word-break: break-all;
}
.mcp-key-desc { font-size: 13px; color: var(--text2); margin-bottom: 14px; }
.mcp-key-display {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg3); border-radius: 8px;
  padding: 10px 12px; margin-bottom: 8px;
}
.mcp-key-display code {
  flex: 1; font-size: 12px; font-family: monospace;
  color: var(--text1); word-break: break-all;
}
.mcp-key-hint { font-size: 12px; color: var(--text2); min-height: 18px; margin-bottom: 12px; }
.mcp-key-actions { display: flex; gap: 10px; }
.danger-ghost { color: var(--danger) !important; }

/* ─── Responsive tweaks ────────────────────────────────────────── */
@media (max-width: 380px) {
  .result-macros { grid-template-columns: repeat(2, 1fr); }
  .hero-section  { flex-direction: column; text-align: center; }
  .calorie-ring-wrapper canvas { width: 150px !important; height: 150px !important; }
}

/* ═══════════════════════════════════════════════════════════════
   AI INSIGHT CARD
   ═══════════════════════════════════════════════════════════════ */

.insight-card {
  padding: 16px; margin-bottom: 20px;
  border-left: 3px solid var(--accent);
}
.insight-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 10px;
}
.insight-tag {
  font-size: 10px; font-weight: 800; text-transform: uppercase;
  letter-spacing: .08em; color: var(--accent);
  background: var(--accent-dim); padding: 3px 8px; border-radius: 20px;
}
.insight-header .icon-btn svg { width: 16px; height: 16px; }
.insight-text {
  font-size: 14px; line-height: 1.7; color: var(--text2);
  font-style: italic;
}
.insight-text.loading { opacity: .5; }

/* ═══════════════════════════════════════════════════════════════
   FASTING MINI-WIDGET (dashboard)
   ═══════════════════════════════════════════════════════════════ */

.fast-widget {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 16px; margin-bottom: 14px;
  cursor: pointer; transition: background .15s;
}
.fast-widget:hover { background: var(--surface-hov); }
.fast-widget-left { display: flex; align-items: center; gap: 12px; }
.fast-dot {
  width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0;
}
.fast-dot.idle    { background: var(--text3); }
.fast-dot.active  { background: var(--accent); box-shadow: 0 0 8px var(--accent-glow);
  animation: pulse-dot 2s ease-in-out infinite; }
.fast-dot.done    { background: var(--carbs); }

@keyframes pulse-dot {
  0%, 100% { opacity: 1; transform: scale(1); }
  50%       { opacity: .6; transform: scale(1.3); }
}

.fast-widget-title { display: block; font-size: 14px; font-weight: 600; }
.fast-widget-sub   { display: block; font-size: 12px; color: var(--text2); margin-top: 2px; }
.fast-widget-timer { font-size: 18px; font-weight: 800; font-variant-numeric: tabular-nums; }

/* ═══════════════════════════════════════════════════════════════
   FASTING TAB
   ═══════════════════════════════════════════════════════════════ */

.fast-timer-card {
  padding: 20px; margin-bottom: 14px;
  display: flex; flex-direction: column; align-items: center; gap: 16px;
}

.fast-timer-wrap {
  position: relative; display: flex;
  align-items: center; justify-content: center;
}
.fast-arc-center {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 2px;
}
.fast-time {
  font-size: 32px; font-weight: 800;
  font-variant-numeric: tabular-nums;
  letter-spacing: -.5px; line-height: 1;
}
.fast-status-sub { font-size: 12px; color: var(--text2); font-weight: 500; }
.fast-pct        { font-size: 13px; font-weight: 700; color: var(--accent); }

.fast-protocol-label {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: .06em; color: var(--text2); margin-bottom: 8px;
  text-align: center;
}
.fast-protocols {
  display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;
}
.proto-btn {
  padding: 8px 16px; border-radius: var(--radius-sm);
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); font-family: var(--font);
  font-size: 13px; font-weight: 700;
  cursor: pointer; transition: all .15s;
}
.proto-btn:hover  { border-color: var(--border-hov); color: var(--text); }
.proto-btn.active {
  background: var(--accent-dim); border-color: var(--accent);
  color: var(--accent);
}

.fast-eating-window {
  text-align: center; font-size: 12px; color: var(--text3);
  margin-top: 8px; min-height: 18px;
}

.danger-ghost {
  display: flex; align-items: center; gap: 6px;
  background: rgba(239,68,68,.08); border: 1px solid rgba(239,68,68,.2);
  color: var(--danger) !important; font-family: var(--font);
  font-size: 13px; font-weight: 600;
  border-radius: var(--radius-sm);
  padding: 9px 14px; cursor: pointer;
  transition: background .15s;
}
.danger-ghost:hover { background: rgba(239,68,68,.15); }

/* Fasting history list */
.fast-history-list { display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px; }
.fast-history-item {
  display: flex; align-items: center; gap: 12px;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 12px 14px;
}
.fhi-icon {
  width: 36px; height: 36px; border-radius: 10px;
  background: var(--bg3); flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px;
}
.fhi-info { flex: 1; }
.fhi-title  { font-size: 14px; font-weight: 600; }
.fhi-meta   { font-size: 12px; color: var(--text2); margin-top: 2px; }
.fhi-result { text-align: right; }
.fhi-hours  { font-size: 16px; font-weight: 800; }
.fhi-label  { display: block; font-size: 10px; color: var(--text2); font-weight: 600;
  text-transform: uppercase; letter-spacing: .04em; }
.fhi-badge {
  font-size: 10px; font-weight: 700; padding: 2px 7px; border-radius: 20px;
  text-transform: uppercase; letter-spacing: .04em;
}
.fhi-badge.completed { background: rgba(74,222,128,.15); color: var(--accent); }
.fhi-badge.cancelled { background: rgba(248,113,113,.15); color: var(--fat); }

/* ═══════════════════════════════════════════════════════════════
   WEIGHT GOAL
   ═══════════════════════════════════════════════════════════════ */

.weight-goal-card { padding: 20px; margin-bottom: 14px; }

.wg-progress-bar-wrap {
  height: 8px; background: var(--border); border-radius: 4px;
  position: relative; overflow: visible; margin: 8px 0 4px;
}
.wg-progress-bar {
  height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2));
  border-radius: 4px; transition: width .6s var(--ease);
  min-width: 0; max-width: 100%;
}
.wg-progress-thumb {
  position: absolute; top: 50%; transform: translateY(-50%) translateX(-50%);
  width: 16px; height: 16px; border-radius: 50%;
  background: #fff; box-shadow: 0 0 0 3px var(--accent);
  transition: left .6s var(--ease);
}
.wg-labels {
  display: flex; justify-content: space-between;
  font-size: 11px; color: var(--text2); margin-top: 6px;
}
.wg-current { font-weight: 700; color: var(--accent) !important; }
.wg-days-left { font-size: 12px; color: var(--text3); margin-top: 6px; }

/* ═══════════════════════════════════════════════════════════════
   NOTIFICATIONS
   ═══════════════════════════════════════════════════════════════ */

.notif-granted svg { stroke: var(--accent); }


/* ─── 6-item nav: slightly tighter ──────────────────────────────── */
.bottom-nav .nav-btn span { letter-spacing: 0; }

/* ─── Notification prompt card ──────────────────────────────────── */
.notif-prompt-card {
  display: flex; align-items: center; gap: 12px;
  padding: 14px 16px; border-radius: var(--radius);
  margin-bottom: 16px; animation: slide-down .4s var(--ease);
}
.notif-prompt-icon { font-size: 22px; flex-shrink: 0; }
.notif-prompt-text { flex: 1; }
.notif-prompt-text strong { display: block; font-size: 14px; font-weight: 600; margin-bottom: 2px; }
.notif-prompt-text span   { font-size: 12px; color: var(--text2); }
.notif-prompt-card .btn-ghost { flex-shrink: 0; padding: 8px 14px; font-size: 13px; }

/* ─── Snap note field ────────────────────────────────────────────── */
.snap-note-wrap { margin-top: 12px; }
.snap-note-input {
  width: 100%; padding: 10px 14px; font-size: 14px;
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius); color: var(--text);
  font-family: var(--font);
  transition: border-color .2s;
}
.snap-note-input::placeholder { color: var(--text3); }
.snap-note-input:focus { outline: none; border-color: var(--accent); }

/* ═══════════════════════════════════════════════════════════════
   CHAT TAB
   ═══════════════════════════════════════════════════════════════ */

#tab-chat .scroll-container {
  display: flex; flex-direction: column;
  height: calc(100vh - var(--top-h) - var(--nav-h));
  overflow: hidden;
  padding: 16px 20px 0;
  max-width: 600px;
}

.chat-messages {
  flex: 1; overflow-y: auto;
  display: flex; flex-direction: column;
  gap: 10px;
  padding: 0 0 12px;
  -webkit-overflow-scrolling: touch;
}

.chat-welcome {
  display: flex; flex-direction: column; align-items: center;
  text-align: center; padding: 32px 16px 16px;
  color: var(--text2); gap: 10px;
}
.chat-welcome-icon { font-size: 40px; }
.chat-welcome p    { font-size: 15px; line-height: 1.5; }

.chat-suggestions {
  display: flex; flex-wrap: wrap; gap: 8px;
  justify-content: center; margin-top: 8px;
}
.chat-suggestion {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 20px; padding: 8px 14px;
  font-size: 13px; color: var(--text2);
  font-family: var(--font); cursor: pointer;
  transition: border-color .2s, color .2s;
}
.chat-suggestion:hover { border-color: var(--accent); color: var(--text); }

.chat-bubble {
  max-width: 80%; padding: 10px 14px;
  border-radius: 18px; font-size: 14px;
  line-height: 1.5; word-break: break-word;
}
.chat-bubble.user {
  align-self: flex-end;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: #0a1a0f; border-bottom-right-radius: 6px;
}
.chat-bubble.assistant {
  align-self: flex-start;
  background: var(--bg2); border: 1px solid var(--border);
  color: var(--text); border-bottom-left-radius: 6px;
}
.chat-bubble.assistant.typing {
  display: flex; gap: 5px; align-items: center;
  padding: 14px 18px;
}
.chat-bubble.assistant.searching-hint {
  padding: 11px 16px; font-size: 13px; color: var(--text2);
  border-style: dashed;
}
.chat-searching { display: flex; align-items: center; gap: 6px; }
.chat-bubble.assistant.typing span {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--text3);
  animation: typingDot 1.2s infinite;
}
.chat-bubble.assistant.typing span:nth-child(2) { animation-delay: .2s; }
.chat-bubble.assistant.typing span:nth-child(3) { animation-delay: .4s; }
@keyframes typingDot {
  0%, 60%, 100% { opacity: .3; transform: translateY(0); }
  30%            { opacity: 1;  transform: translateY(-4px); }
}

.chat-input-wrap {
  display: flex; gap: 10px; align-items: center;
  padding: 12px 0 calc(12px + env(safe-area-inset-bottom));
  border-top: 1px solid var(--border);
  background: var(--bg);
}
.chat-input {
  flex: 1; padding: 12px 16px; font-size: 15px;
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 24px; color: var(--text);
  font-family: var(--font);
  transition: border-color .2s;
}
.chat-input::placeholder { color: var(--text3); }
.chat-input:focus { outline: none; border-color: var(--accent); }
.chat-send-btn {
  width: 44px; height: 44px; flex-shrink: 0;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border: none; border-radius: 50%; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: opacity .2s, transform .15s;
}
.chat-send-btn:disabled { opacity: .4; }
.chat-send-btn svg { width: 18px; height: 18px; stroke: #0a1a0f; }
.chat-send-btn:not(:disabled):active { transform: scale(.92); }

.chat-search-badge {
  display: inline-block; margin-bottom: 6px;
  font-size: 11px; font-weight: 600; color: var(--text3);
  background: rgba(255,255,255,0.06);
  border: 1px solid var(--border);
  border-radius: 10px; padding: 2px 8px;
}


::-webkit-scrollbar       { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

/* ─── Install prompt ─────────────────────────────────────────── */
.install-banner {
  position: fixed; top: calc(var(--top-h) + 8px);
  left: 16px; right: 16px; z-index: 200;
  background: var(--bg2); border: 1px solid var(--accent);
  border-radius: var(--radius);
  padding: 12px 16px;
  display: flex; align-items: center; gap: 12px;
  animation: slide-down .4s var(--ease);
  box-shadow: 0 8px 32px rgba(0,0,0,.6);
}
.install-banner span { flex: 1; font-size: 13px; color: var(--text2); }
.install-banner strong { color: var(--text); }
.install-banner .btn-primary { margin: 0; padding: 8px 16px; font-size: 13px; width: auto; flex-shrink: 0; }
.install-banner .icon-btn { flex-shrink: 0; }

@keyframes slide-down {
  from { transform: translateY(-20px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}
